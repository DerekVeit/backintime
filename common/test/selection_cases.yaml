
simple:
    includes:
        - /var
    excludes: []
    files_tree: |
        var/
            log/
                dmesg
                syslog
    expected_tree: |
        var/
            log/
                dmesg
                syslog

exclude-star:
    includes:
        - /var
    excludes:
        - /var/*
    files_tree: |
        var/
            log/
                dmesg
                syslog
    expected_tree: |
        NONE

exclude-name:
    includes:
        - /var
    excludes:
        - log
    files_tree: |
        var/
            lib/
                foo
                log
            log/
                dmesg
                syslog
    expected_tree: |
        var/
            lib/
                foo

exclude-absolute-dir:
    includes:
        - /var
    excludes:
        - /var/log
    files_tree: |
        var/
            lib/
                log
            log/
                dmesg
                syslog
    expected_tree: |
        var/
            lib/
                log

issue-561:
    flags:
        - original_fails
    includes:
        - /var
        - /var/log/bar    # original: causes everything else in /var/log/ to also get included.
    excludes:
        - /var/log        # sorted: this is treated as /var/log/** to allow the include.
    files_tree: |
        var/
            lib/
                log
            log/
                bar/
                    bar.log
                foo/
                    foo.log
                syslog
    expected_tree: |
        var/
            lib/
                log
            log/
                bar/
                    bar.log

issue-1419-closed:
    includes:
        - /var
    excludes:
        - '[Tt]emp/*'
    files_tree: |
        var/
            Temp/
                file1
            Temperature
    expected_tree: |
        var/
            Temp/
            Temperature

issue-1420:
    flags:
        - original_fails
            # With original strategy, /home/xin/.ssh gets backed up as it should,
            # but /home/xin/.gitignore doesn't.
    includes:
        - /home
        - /home/xin/.gitignore
        - /home/xin/.ssh
    excludes:
        - /home/xin/.*
    files_tree: |
        home/
            xin/
                .other-dir/
                    foo
                .ssh/
                    config
                .gitignore
                .other
    expected_tree: |
        home/
            xin/
                .ssh/
                    config
                .gitignore

various:
    flags:
        - original_fails
    includes:
        - /
        - /var
        - /var/log/keep
        - /var/log/keep/bar.log
        - /var/log/special.bak
        - /var/log/keep/x/x2
    excludes:
        - /var/log/**  # With original strategy, this supersedes the more specific includes above.
        - '[a-c]ar.log'
        - keep/ba*.log
        - '*.bak'
        - /var/log/keep/x/**
    files_tree: |
        var/
            log/
                keep/
                    more/
                        bar.log.bak
                    x/
                        x1
                        x2
                    bar.log
                    baz.log
                    car.log
                    foo.log
                    foo.log.bak
                special.bak
                syslog
        root_file
    expected_tree: |
        var/
            log/
                keep/
                    more/
                    x/
                        x2
                    bar.log
                    foo.log
                special.bak
        root_file

fs-root-exclude-all:
    flags:
        - original_fails
        - fs_root       # Cannot simulate "/" in a prefixed temp dir for this one.
    includes:
        - /
        - /etc/issue
    excludes:
        - /**
        - '*.pyc'
    files_tree: |
        NONE
    expected_tree: |
        etc/
            issue

fs-root-exclude-root:
    flags:
        - sorted_only   # With original selection mode, it would try to copy everything.
        - original_fails
        - fs_root       # Cannot simulate "/" in a prefixed temp dir for this one.
    includes:
        - /
        - /etc/issue
    excludes:
        - /             # This has no effect in the original selection mode, so /** would be included.
        - '*.pyc'
    files_tree: |
        NONE
    expected_tree: |
        etc/
            issue
